---
layout: default
title: "Searching"
date: 2019-09-24
categories: Tutorials
---
<div>
  <h2>Searching</h2>

  <p>The primary method of searching for malware samples is to use the built-in Malware Analysis Center Query Language (MACQL). This query language provides a simple, powerful, and easy-to-use interface to find malware samples that meet specific criteria.</p>

  <h3>Example</h3>
  <div>
    <pre><code>
    <font color="Purple">name</font> <font color="Blue">contains</font> <font color="Orange">"emotet"</font> <font color="Blue">and</font> <font color="Purple">positives</font> <font color="Blue">></font> <font color="DarkRed">20</font>
    </code></pre>
    <caption>This query will return all files where at least 20 AV engines detected it as malicious and at least one AV engine had "emotet" in the resulting output from the AV detection.</caption>
  </div>
  <h3>Definitions</h3>
  <ul>
    <li><strong>Field: </strong> a property of a sample (e.g. SHA1).</li>
    <li>
      <strong>Operator: </strong> a function that acts on a left and right input and will always return a boolean value. There are two kinds of operators: Comparison and Logical.
      <ul>
        <li><strong>Comparison Operator: </strong> a method of comparing a field with a value (e.g. >).</li>
        <li><strong>Logical Operator: </strong> a method of comparing two boolean values (e.g. and/or).</li>
      </ul>
    </li>
    <li>
      <strong>Value: </strong> something that can be compared to a field (e.g. 17, 7.2, and "xagent").
      <ul>
        <li><strong>String: </strong> a set of Unicode characters surrounded by quotes. Backslash is the escape character (e.g. "mydoom").</li>
        <li><strong>Integer: </strong> a 32-bit whole number (e.g. 42).</li>
        <li><strong>Float: </strong> a 32-bit decimal number (e.g. 3.14).</li>
      </ul>
    </li>
  </ul>

  <h3>Fields</h3>
  <table>
    <tr>
      <th>Field</th>
      <th>Description</th>
      <th>Operators</th>
      <th>Type</th>
      <th>Example</th>
    </tr>
    <tr>
      <td>name</td>
      <td>This field will match on any positive AV detection result where the comparison returns true. The comparison performed is case-insensitive.</td>
      <td>contains</td>
      <td>string</td>
      <td>"dridex"</td>
    </tr>
    <tr>
      <td>total</td>
      <td>The total number of AV engines that scanned this particular file.</td>
      <td>>, >=, <, <=, and =</td>
      <td>integer</td>
      <td>42</td>
    </tr>
    <tr>
      <td>positives</td>
      <td>The number of positive AV engine detections.</td>
      <td>>, >=, <, <=, and =</td>
      <td>integer</td>
      <td>25</td>
    </tr>
    <tr>
      <td>md5</td>
      <td>The MD5 hash of the file. The search is case-insensitive.</td>
      <td>=</td>
      <td>string</td>
      <td>02cfa3e6fdb4301528e5152de76b2abf</td>
    </tr>
    <tr>
      <td>sha1</td>
      <td>The SHA1 hash of the file. The search is case-insensitive.</td>
      <td>=</td>
      <td>string</td>
      <td>ed205f958fc9a60f3396384d9e1c75feb5b76a91</td>
    </tr>
    <tr>
      <td>sha256</td>
      <td>The SHA256 hash of the file. The search is case-insensitive.</td>
      <td>=</td>
      <td>string</td>
      <td>7bcb0abcfbea20ecfe31d8dd65146b8b1ffd0d81479d11dc329b2f99e263bd78</td>
    </tr>
    <tr>
      <td>list</td>
      <td>Either Whitelist, Blacklist, Greylist, or Unknown.</td>
      <td>=</td>
      <td>string</td>
      <td>Blacklist</td>
    </tr>
    <tr>
      <td>filetype</td>
      <td>The extension of the file type.</td>
      <td>=</td>
      <td>string</td>
      <td>exe</td>
    </tr>
    <tr>
      <td>submitted</td>
      <td>The date the file was submitted to the Malware Analysis Center.</td>
      <td>>, >=, <, <=, and =</td>
      <td>string</td>
      <td>"1 May 2019"<td>
    </tr>
    <tr>
      <td>rulename</td>
      <td>The name of the a Yara rule contained within a Yara ruleset. This field will match on all files where the specified rulename fired.</td>
      <td>contains</td>
      <td>string</td>
      <td>Win_Trojan_Dridex_24</td>
    </tr>
    <tr>
      <td>rulesetname</td>
      <td>The name of the a Yara rule set. This field will match on all files where any rule in the specified ruleset fired.</td>
      <td>contains</td>
      <td>string</td>
      <td>ClamAV - Windows Trojans</td>
    </tr>
  </table>
<!--
<ul>
    <li>{{ page.title }}</li>
    <li>{{ page.url }}</li>
    <li>{{ site.baseurl }}</li>
    <li>{{ page.path }}</li>
    <li>{{ page.url | prepend:site.baseurl }}</li>
    <li>{{ site.url }}</li>
  </ul>
-->
</div>
